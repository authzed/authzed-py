[tool.poetry]
authors = ["Authzed <support@authzed.com>"]
description = "Client library for SpiceDB."

name = "authzed"
# The version is set at publish time with a call to `poetry version -s <tag>`,
# where the tag comes from the release.
version = "0.0.0"
packages = [
  {include = "authzed"},
  # This is the protovalidate-related code
  {include = "buf"},
  # NOTE: this is the old validate package that won't be used,
  # but the code generated by it is referenced in the generated protobuf/gRPC code.
  {include = "validate"},
  {include = "grpcutil"},
  # NOTE: this is the proto for the grpc-gateway, which isn't explicitly used
  # in the functionality of this package, but is imported by library code.
  {include = "protoc_gen_openapiv2"},
]
readme = "README.md"

[tool.poetry.dependencies]
grpcio = "^1.63"
protobuf = ">=5.26,<6"
python = "^3.9"
grpc-interceptor = "^0.15.4"
googleapis-common-protos = "^1.65.0"
protovalidate = ">=0.7.1,<1.1.0"

[tool.poetry.group.dev.dependencies]
grpc-stubs = "^1.53"
grpcio-tools = ">=1.63,<1.72"
mypy = "1.18.1"
mypy-protobuf = "3.6.0"
mock = "^5.1.0"
pytest = ">=7.1.3,<9.0.0"
pytest-asyncio = ">=0.21,<1.3"
types-protobuf = ">=5.26,<7.0"
typing-extensions = ">=3.7.4,<5"
ruff = "^0.13.0"

[tool.ruff]
exclude = [
"*_pb2.py",
"*_grpc.py",
"*_pb2.pyi",
"*_grpc.pyi",
]
line-length = 100

[tool.mypy]
explicit_package_bases = true

[[tool.mypy.overrides]]
ignore_missing_imports = true
module = ["google.rpc.*", "grpcutil"]

[tool.pytest.ini_options]
addopts = "-x"
log_level = "debug"
minversion = "6.0"
asyncio_mode = "auto"

[build-system]
build-backend = "poetry.core.masonry.api"
requires = ["poetry-core>=1.0.0"]
